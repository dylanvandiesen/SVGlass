<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Metal Border Generator PRO - 3 Band Metal Lines</title>
  <style>
    :root {
      --border-size: 20;
      --radius: 38;
      --base-angle: 28;
      --scroll-progress: 0;
      --scroll-drive: 1;
      --light-elevation: 0.76;
      --light-intensity: 1.25;

      --o-enable: 1; --o-width: 5.5; --o-offset: 0;
      --s-enable: 1; --s-width: 10;  --s-offset: 0;
      --i-enable: 1; --i-width: 5.5; --i-offset: 0;

      --outer-shadow-x: 0; --outer-shadow-y: 10; --outer-shadow-blur: 24;
      --outer-shadow-r: 0; --outer-shadow-g: 0; --outer-shadow-b: 0; --outer-shadow-a: 0.32;
    }

    @property --scroll-progress { syntax: "<number>"; inherits: true; initial-value: 0; }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      min-height: 280vh;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
      color: #f2f6ff;
      background: radial-gradient(circle at 12% 9%, #35456f 0, #1a2032 44%, #0c0f18 100%);
    }

    .layout { display:grid; grid-template-columns:minmax(330px,440px) 1fr; gap:1rem; padding:1rem; align-items:start; }
    .panel {
      position: sticky; top:.5rem; max-height: calc(100vh - 1rem); overflow:auto;
      padding:.9rem; border-radius:16px; border:1px solid rgba(255,255,255,.14);
      background: rgba(16,20,32,.86); backdrop-filter: blur(10px);
    }
    h2 { margin:.1rem 0 .45rem; font-size:1.08rem; }
    .panel p { margin:0 0 .7rem; font-size:.82rem; opacity:.86; }
    .sec { border-top:1px solid rgba(255,255,255,.12); margin-top:.7rem; padding-top:.7rem; }
    .sec h3 { margin:0 0 .45rem; font-size:.87rem; }
    label { display:block; margin:.34rem 0; font-size:.77rem; }
    .cap { display:flex; justify-content:space-between; gap:.4rem; margin-bottom:.1rem; }
    input[type="range"], select, input[type="color"] { width:100%; }
    input[type="color"] { height:36px; border:none; border-radius:8px; background:transparent; }
    .row2 { display:grid; grid-template-columns:1fr 1fr; gap:.5rem; }

    .stage { min-height:96vh; display:grid; place-items:center; padding:1rem; }
    .frame {
      position: relative;
      width:min(92vw,900px);
      min-height:min(66vh,580px);
      border-radius: calc(var(--radius) * 1px);
      overflow: hidden;
      isolation: isolate;
      background: transparent;
    }

    .line-layer {
      position:absolute; inset:0; border-radius:inherit; pointer-events:none;
      background: paint(metal-band);
    }

    .line-outer {
      --band-id: 0;
      mix-blend-mode: var(--o-blend, screen);
      opacity: var(--o-opacity, 1);
      filter: brightness(var(--o-brightness,1)) contrast(var(--o-contrast,1.05)) saturate(var(--o-saturate,1.1)) hue-rotate(calc(var(--o-hue,0)*1deg)) blur(calc(var(--o-blur,0)*1px));
    }
    .line-surface {
      --band-id: 1;
      mix-blend-mode: var(--s-blend, normal);
      opacity: var(--s-opacity, 1);
      filter: brightness(var(--s-brightness,1)) contrast(var(--s-contrast,1.08)) saturate(var(--s-saturate,1.08)) hue-rotate(calc(var(--s-hue,0)*1deg)) blur(calc(var(--s-blur,0)*1px));
    }
    .line-inner {
      --band-id: 2;
      mix-blend-mode: var(--i-blend, multiply);
      opacity: var(--i-opacity, 1);
      filter: brightness(var(--i-brightness,1)) contrast(var(--i-contrast,1.1)) saturate(var(--i-saturate,1.0)) hue-rotate(calc(var(--i-hue,0)*1deg)) blur(calc(var(--i-blur,0)*1px));
    }

    .shadow {
      position:absolute; inset:0; border-radius:inherit; pointer-events:none;
      box-shadow: calc(var(--outer-shadow-x)*1px) calc(var(--outer-shadow-y)*1px) calc(var(--outer-shadow-blur)*1px) rgba(var(--outer-shadow-r),var(--outer-shadow-g),var(--outer-shadow-b),var(--outer-shadow-a));
    }

    @supports (animation-timeline: scroll()) {
      body { animation: prog linear both; animation-timeline: scroll(root); animation-range: 0% 100%; }
      @keyframes prog { from { --scroll-progress: 0; } to { --scroll-progress: 1; } }
    }

    @media (max-width: 930px) {
      .layout { grid-template-columns:1fr; }
      .panel { position:fixed; left:.6rem; right:.6rem; bottom:.6rem; top:auto; max-height:47vh; z-index:20; }
      .stage { padding-bottom:49vh; }
    }
  </style>
</head>
<body>
  <div class="layout">
    <aside class="panel" id="panel">
      <h2>Metal Border Generator PRO</h2>
      <p>Three physical metal lines: <b>outer bevel</b>, <b>surface</b>, <b>inner bevel</b>. Each line has independent material, fresnel, texture, blending, and filters.</p>

      <div class="sec" id="global-sec">
        <h3>Global Geometry + Light</h3>
        <label><span class="cap">Border size <output data-out="--border-size"></output></span><input data-var="--border-size" type="range" min="0" max="120" step="0.1" value="20"></label>
        <label><span class="cap">Radius <output data-out="--radius"></output></span><input data-var="--radius" type="range" min="0" max="140" step="1" value="38"></label>
        <label><span class="cap">Base angle <output data-out="--base-angle"></output></span><input data-var="--base-angle" type="range" min="0" max="360" step="1" value="28"></label>
        <label><span class="cap">Scroll drive <output data-out="--scroll-drive"></output></span><input data-var="--scroll-drive" type="range" min="0" max="6" step="0.01" value="1"></label>
        <label><span class="cap">Light elevation <output data-out="--light-elevation"></output></span><input data-var="--light-elevation" type="range" min="0" max="1" step="0.01" value="0.76"></label>
        <label><span class="cap">Light intensity <output data-out="--light-intensity"></output></span><input data-var="--light-intensity" type="range" min="0" max="3" step="0.01" value="1.25"></label>
      </div>

      <div id="bands"></div>
    </aside>

    <main class="stage">
      <div class="frame">
        <div class="line-layer line-surface"></div>
        <div class="line-layer line-outer"></div>
        <div class="line-layer line-inner"></div>
        <div class="shadow"></div>
      </div>
    </main>
  </div>

<script>
const WORKLET = `
class MetalBandPainter {
  static get inputProperties() {
    const props = [
      '--band-id','--border-size','--radius','--base-angle','--scroll-progress','--scroll-drive','--light-elevation','--light-intensity'
    ];
    const ids=['o','s','i'];
    for (const id of ids) {
      props.push(
        '--'+id+'-enable','--'+id+'-width','--'+id+'-offset',
        '--'+id+'-grad-type','--'+id+'-interp','--'+id+'-arms-count','--'+id+'-arms-width','--'+id+'-arms-contrast','--'+id+'-arms-spin',
        '--'+id+'-fresnel-strength','--'+id+'-fresnel-width','--'+id+'-fresnel-power',
        '--'+id+'-texture-type','--'+id+'-texture-scale','--'+id+'-texture-strength','--'+id+'-texture-roughness',
        '--'+id+'-c1-r','--'+id+'-c1-g','--'+id+'-c1-b','--'+id+'-c1-a',
        '--'+id+'-c2-r','--'+id+'-c2-g','--'+id+'-c2-b','--'+id+'-c2-a',
        '--'+id+'-c3-r','--'+id+'-c3-g','--'+id+'-c3-b','--'+id+'-c3-a',
        '--'+id+'-c4-r','--'+id+'-c4-g','--'+id+'-c4-b','--'+id+'-c4-a',
        '--'+id+'-fresnel-r','--'+id+'-fresnel-g','--'+id+'-fresnel-b','--'+id+'-fresnel-a',
        '--'+id+'-tex-r','--'+id+'-tex-g','--'+id+'-tex-b','--'+id+'-tex-a'
      );
    }
    return props;
  }
  p(props,n,d=0){ const v=parseFloat((props.get(n)||'').toString()); return Number.isFinite(v)?v:d; }
  c(props,pfx,n){ return [this.p(props,'--'+pfx+'-'+n+'-r',255),this.p(props,'--'+pfx+'-'+n+'-g',255),this.p(props,'--'+pfx+'-'+n+'-b',255),this.p(props,'--'+pfx+'-'+n+'-a',1)]; }
  hash(x,y){ return (Math.sin(x*127.1+y*311.7)*43758.5453)%1; }

  grad(ctx, type, angle, cx, cy, w, h, border) {
    if (type===1) return ctx.createLinearGradient(cx-Math.cos(angle)*cx, cy-Math.sin(angle)*cy, cx+Math.cos(angle)*cx, cy+Math.sin(angle)*cy);
    if (type===2) return ctx.createRadialGradient(cx,cy,border*0.2,cx,cy,Math.max(w,h)*0.55);
    return ctx.createConicGradient(angle,cx,cy);
  }

  bandCenter(border, width, offset, bandId) {
    if (bandId===0) return Math.max(width*0.5, width*0.5 + offset);           // outer bevel center
    if (bandId===2) return Math.max(width*0.5, border - width*0.5 + offset);  // inner bevel center
    return Math.max(width*0.5, border*0.5 + offset);                           // surface center
  }

  strokeBand(ctx, inset, w, h, radius, width) {
    if (width<=0 || w<=inset*2 || h<=inset*2) return;
    ctx.lineWidth=width;
    ctx.beginPath();
    ctx.roundRect(inset, inset, Math.max(0,w-inset*2), Math.max(0,h-inset*2), Math.max(0,radius-inset));
    ctx.stroke();
  }

  paint(ctx, size, props) {
    const bandId = Math.floor(this.p(props,'--band-id',0));
    const pfx = ['o','s','i'][Math.max(0,Math.min(2,bandId))];

    const w=size.width, h=size.height;
    const border=Math.max(0,this.p(props,'--border-size',20));
    if(border<=0.01) return;
    const radius=Math.max(0,this.p(props,'--radius',34));
    const enabled=this.p(props,'--'+pfx+'-enable',1);
    if(enabled<0.5) return;

    const width=Math.max(0,this.p(props,'--'+pfx+'-width',6));
    if(width<=0.01) return;
    const offset=this.p(props,'--'+pfx+'-offset',0);

    const base=this.p(props,'--base-angle',0), prog=this.p(props,'--scroll-progress',0), drive=this.p(props,'--scroll-drive',1);
    const angle=((base + prog*360*drive)%360)*(Math.PI/180);
    const elev=this.p(props,'--light-elevation',0.75), inten=this.p(props,'--light-intensity',1.2);
    const cx=w*0.5, cy=h*0.5;

    const c1=this.c(props,pfx,'c1'), c2=this.c(props,pfx,'c2'), c3=this.c(props,pfx,'c3'), c4=this.c(props,pfx,'c4');
    const gType=Math.floor(this.p(props,'--'+pfx+'-grad-type',0));
    const interp=Math.max(0.2,this.p(props,'--'+pfx+'-interp',1));

    const center=this.bandCenter(border,width,offset,bandId);

    const g=this.grad(ctx,gType,angle,cx,cy,w,h,border);
    g.addColorStop(0,'rgba('+c1[0]+','+c1[1]+','+c1[2]+','+c1[3]+')');
    g.addColorStop(Math.min(1,Math.pow(0.26,interp)),'rgba('+c2[0]+','+c2[1]+','+c2[2]+','+c2[3]+')');
    g.addColorStop(Math.min(1,Math.pow(0.64,interp)),'rgba('+c3[0]+','+c3[1]+','+c3[2]+','+c3[3]+')');
    g.addColorStop(1,'rgba('+c4[0]+','+c4[1]+','+c4[2]+','+c4[3]+')');

    ctx.strokeStyle=g;
    this.strokeBand(ctx,center,w,h,radius,width);

    // directional arms inside each line
    const arms=Math.max(1,Math.floor(this.p(props,'--'+pfx+'-arms-count',8)));
    const aw=Math.max(0.01,Math.min(0.99,this.p(props,'--'+pfx+'-arms-width',0.3)));
    const ac=this.p(props,'--'+pfx+'-arms-contrast',0.5);
    const spin=this.p(props,'--'+pfx+'-arms-spin',1.2);
    const arm=ctx.createConicGradient(angle*spin,cx,cy);
    for(let i=0;i<arms;i++){
      const s=i/arms,m=(i+aw*0.5)/arms,e=(i+aw)/arms;
      arm.addColorStop(s%1,'rgba(255,255,255,0)');
      arm.addColorStop(m%1,'rgba(255,255,255,'+(0.32*ac)+')');
      arm.addColorStop(e%1,'rgba(0,0,0,'+(0.15*ac)+')');
    }
    ctx.globalCompositeOperation='overlay';
    ctx.strokeStyle=arm;
    this.strokeBand(ctx,center,w,h,radius,width);
    ctx.globalCompositeOperation='source-over';

    // Fresnel on the same line
    const frS=this.p(props,'--'+pfx+'-fresnel-strength',0.4);
    const frW=this.p(props,'--'+pfx+'-fresnel-width',0.35);
    const frP=Math.max(0.2,this.p(props,'--'+pfx+'-fresnel-power',3));
    const frc=this.c(props,pfx,'fresnel');
    if(frS>0){
      const steps=Math.max(8,Math.floor(width*2));
      for(let i=0;i<steps;i++){
        const t=i/steps;
        const edge=Math.abs((t-0.5)/0.5);
        const fres=Math.pow(1-edge,frP) * frS * (0.5 + elev*0.7) * inten;
        const a=fres*Math.max(0,1-Math.abs(t-frW));
        if(a<=0.0007) continue;
        ctx.strokeStyle='rgba('+frc[0]+','+frc[1]+','+frc[2]+','+(frc[3]*a)+')';
        this.strokeBand(ctx, center - width*0.5 + t*width, w, h, radius, Math.max(0.45,width/steps+0.2));
      }
    }

    // Texture per line
    const tt=Math.floor(this.p(props,'--'+pfx+'-texture-type',1));
    if(tt!==0){
      const ts=Math.max(0.1,this.p(props,'--'+pfx+'-texture-scale',1));
      const ta=this.p(props,'--'+pfx+'-texture-strength',0.35);
      const tr=this.p(props,'--'+pfx+'-texture-roughness',0.3);
      const tc=this.c(props,pfx,'tex');
      const rw=Math.max(1,w-center*2), rh=Math.max(1,h-center*2);
      const perim=Math.max(1,2*(rw+rh));
      const cnt=Math.min(1200,Math.floor(perim*(0.11+ts*0.08)));
      ctx.strokeStyle='rgba('+tc[0]+','+tc[1]+','+tc[2]+','+(tc[3]*ta*0.28)+')';
      ctx.fillStyle='rgba('+tc[0]+','+tc[1]+','+tc[2]+','+(tc[3]*ta*0.24)+')';
      for(let i=0;i<cnt;i++){
        const u=i/cnt; const side=Math.floor(u*4), t=(u*4)-side;
        let x=0,y=0;
        if(side===0){x=center+rw*t;y=center;} else if(side===1){x=center+rw;y=center+rh*t;} else if(side===2){x=center+rw*(1-t);y=center+rh;} else {x=center;y=center+rh*(1-t);}        
        const nx=(this.hash(i,13.1)-0.5)*width*0.6;
        const ny=(this.hash(i,27.7)-0.5)*width*0.6;
        if(tt===1){
          const len=1.2 + this.hash(i,55.1)*width*0.4;
          ctx.beginPath(); ctx.moveTo(x+nx,y+ny); ctx.lineTo(x+nx+Math.cos(angle)*len,y+ny+Math.sin(angle)*len); ctx.stroke();
        } else if(tt===2){
          const r=0.3 + this.hash(i,41.3)*1.3*tr;
          ctx.beginPath(); ctx.arc(x+nx,y+ny,r,0,Math.PI*2); ctx.fill();
        } else if(tt===3){
          const r=0.45 + this.hash(i,71.9)*2.1*tr;
          ctx.beginPath(); ctx.arc(x+nx,y+ny,r,0,Math.PI*2); ctx.stroke();
        } else {
          const l=1 + this.hash(i,62.2)*2.4;
          ctx.beginPath(); ctx.moveTo(x+nx-l,y+ny); ctx.lineTo(x+nx+l,y+ny); ctx.moveTo(x+nx,y+ny-l); ctx.lineTo(x+nx,y+ny+l); ctx.stroke();
        }
      }
    }
  }
}
registerPaint('metal-band', MetalBandPainter);
`;

(async()=>{
  if(!('paintWorklet' in CSS)) return alert('CSS Paint API not supported in this browser.');
  const blob=new Blob([WORKLET],{type:'text/javascript'});
  await CSS.paintWorklet.addModule(URL.createObjectURL(blob));
})();

const root=document.documentElement;
function setVar(k,v){ root.style.setProperty(k,String(v)); }
function out(k,v){ const o=document.querySelector('[data-out="'+k+'"]'); if(o) o.textContent=String(v); }

function bindVar(el){
  const key=el.dataset.var;
  const apply=()=>{ setVar(key,el.value); out(key,el.value); };
  el.addEventListener('input',apply,{passive:true});
  apply();
}

function hexToRgb(hex){ const v=parseInt(hex.replace('#',''),16); return {r:(v>>16)&255,g:(v>>8)&255,b:v&255}; }
function bindColor(input,prefix){
  const apply=()=>{ const c=hexToRgb(input.value); setVar(prefix+'-r',c.r); setVar(prefix+'-g',c.g); setVar(prefix+'-b',c.b); };
  input.addEventListener('input',apply,{passive:true});
  apply();
}

function createBandUI(prefix, label, defaults){
  const host=document.createElement('div');
  host.className='sec';
  host.innerHTML='\n    <h3>'+label+' (independent metal line)</h3>\n    <label><span class="cap">Enable</span><select data-var="--'+prefix+'-enable"><option value="1">On</option><option value="0">Off</option></select></label>\n    <label><span class="cap">Width <output data-out="--'+prefix+'-width"></output></span><input data-var="--'+prefix+'-width" type="range" min="0" max="40" step="0.1" value="'+defaults.width+'"></label>\n    <label><span class="cap">Edge offset <output data-out="--'+prefix+'-offset"></output></span><input data-var="--'+prefix+'-offset" type="range" min="-30" max="30" step="0.1" value="'+defaults.offset+'"></label>\n\n    <label><span class="cap">Gradient type</span><select data-var="--'+prefix+'-grad-type"><option value="0">Conic</option><option value="1">Linear</option><option value="2">Radial</option></select></label>\n    <label><span class="cap">Interpolation <output data-out="--'+prefix+'-interp"></output></span><input data-var="--'+prefix+'-interp" type="range" min="0.2" max="3" step="0.01" value="'+defaults.interp+'"></label>\n\n    <label><span class="cap">Arms count <output data-out="--'+prefix+'-arms-count"></output></span><input data-var="--'+prefix+'-arms-count" type="range" min="1" max="40" step="1" value="'+defaults.armsCount+'"></label>\n    <label><span class="cap">Arms width <output data-out="--'+prefix+'-arms-width"></output></span><input data-var="--'+prefix+'-arms-width" type="range" min="0.01" max="0.99" step="0.01" value="'+defaults.armsWidth+'"></label>\n    <label><span class="cap">Arms contrast <output data-out="--'+prefix+'-arms-contrast"></output></span><input data-var="--'+prefix+'-arms-contrast" type="range" min="0" max="1" step="0.01" value="'+defaults.armsContrast+'"></label>\n    <label><span class="cap">Arms spin <output data-out="--'+prefix+'-arms-spin"></output></span><input data-var="--'+prefix+'-arms-spin" type="range" min="0" max="6" step="0.01" value="'+defaults.armsSpin+'"></label>\n\n    <div class="row2" data-colors></div>\n\n    <label><span class="cap">Fresnel strength <output data-out="--'+prefix+'-fresnel-strength"></output></span><input data-var="--'+prefix+'-fresnel-strength" type="range" min="0" max="2" step="0.01" value="'+defaults.fStrength+'"></label>\n    <label><span class="cap">Fresnel width <output data-out="--'+prefix+'-fresnel-width"></output></span><input data-var="--'+prefix+'-fresnel-width" type="range" min="0" max="1" step="0.01" value="'+defaults.fWidth+'"></label>\n    <label><span class="cap">Fresnel power <output data-out="--'+prefix+'-fresnel-power"></output></span><input data-var="--'+prefix+'-fresnel-power" type="range" min="0.2" max="8" step="0.01" value="'+defaults.fPower+'"></label>\n    <div class="row2">\n      <label><span class="cap">Fresnel color</span><input type="color" data-color="--'+prefix+'-fresnel" value="'+defaults.fColor+'"></label>\n      <label><span class="cap">Fresnel alpha <output data-out="--'+prefix+'-fresnel-a"></output></span><input data-var="--'+prefix+'-fresnel-a" type="range" min="0" max="1" step="0.01" value="'+defaults.fAlpha+'"></label>\n    </div>\n\n    <label><span class="cap">Texture type</span><select data-var="--'+prefix+'-texture-type"><option value="0">None</option><option value="1">Brushed</option><option value="2">Cast</option><option value="3">Hammered</option><option value="4">Anisotropic Cross</option></select></label>\n    <label><span class="cap">Texture scale <output data-out="--'+prefix+'-texture-scale"></output></span><input data-var="--'+prefix+'-texture-scale" type="range" min="0.1" max="8" step="0.01" value="'+defaults.tScale+'"></label>\n    <label><span class="cap">Texture strength <output data-out="--'+prefix+'-texture-strength"></output></span><input data-var="--'+prefix+'-texture-strength" type="range" min="0" max="1" step="0.01" value="'+defaults.tStrength+'"></label>\n    <label><span class="cap">Texture roughness <output data-out="--'+prefix+'-texture-roughness"></output></span><input data-var="--'+prefix+'-texture-roughness" type="range" min="0" max="1" step="0.01" value="'+defaults.tRough+'"></label>\n    <div class="row2">\n      <label><span class="cap">Texture tint</span><input type="color" data-color="--'+prefix+'-tex" value="'+defaults.tColor+'"></label>\n      <label><span class="cap">Texture alpha <output data-out="--'+prefix+'-tex-a"></output></span><input data-var="--'+prefix+'-tex-a" type="range" min="0" max="1" step="0.01" value="'+defaults.tAlpha+'"></label>\n    </div>\n\n    <h3>Mix + Filters ('+label+')</h3>\n    <label><span class="cap">Blend</span><select data-var="--'+prefix+'-blend"><option>normal</option><option>overlay</option><option>screen</option><option>multiply</option><option>soft-light</option><option>hard-light</option><option>color-dodge</option><option>color-burn</option><option>difference</option><option>luminosity</option></select></label>\n    <label><span class="cap">Opacity <output data-out="--'+prefix+'-opacity"></output></span><input data-var="--'+prefix+'-opacity" type="range" min="0" max="1" step="0.01" value="'+defaults.opacity+'"></label>\n    <label><span class="cap">Brightness <output data-out="--'+prefix+'-brightness"></output></span><input data-var="--'+prefix+'-brightness" type="range" min="0.2" max="3" step="0.01" value="'+defaults.brightness+'"></label>\n    <label><span class="cap">Contrast <output data-out="--'+prefix+'-contrast"></output></span><input data-var="--'+prefix+'-contrast" type="range" min="0.2" max="3" step="0.01" value="'+defaults.contrast+'"></label>\n    <label><span class="cap">Saturate <output data-out="--'+prefix+'-saturate"></output></span><input data-var="--'+prefix+'-saturate" type="range" min="0" max="4" step="0.01" value="'+defaults.saturate+'"></label>\n    <label><span class="cap">Hue <output data-out="--'+prefix+'-hue"></output></span><input data-var="--'+prefix+'-hue" type="range" min="0" max="360" step="1" value="'+defaults.hue+'"></label>\n    <label><span class="cap">Blur <output data-out="--'+prefix+'-blur"></output></span><input data-var="--'+prefix+'-blur" type="range" min="0" max="6" step="0.1" value="'+defaults.blur+'"></label>\n  ';

  const colorArea=host.querySelector('[data-colors]');
  const stops=[['c1',defaults.c1,defaults.a1],['c2',defaults.c2,defaults.a2],['c3',defaults.c3,defaults.a3],['c4',defaults.c4,defaults.a4]];
  for(const [id,hex,a] of stops){
    const row=document.createElement('label');
    row.innerHTML='<span class="cap">'+id.toUpperCase()+' color</span><input type="color" data-color="--'+prefix+'-'+id+'" value="'+hex+'">\n<span class="cap">'+id.toUpperCase()+' alpha <output data-out="--'+prefix+'-'+id+'-a"></output></span><input data-var="--'+prefix+'-'+id+'-a" type="range" min="0" max="1" step="0.01" value="'+a+'">';
    colorArea.appendChild(row);
  }

  return host;
}

const bandsHost=document.getElementById('bands');
bandsHost.appendChild(createBandUI('o','Outer Bevel',{
  width:5.5,offset:0,interp:1.2,armsCount:8,armsWidth:.28,armsContrast:.55,armsSpin:1.15,
  c1:'#ffffff',a1:.95,c2:'#d6dde8',a2:.86,c3:'#8e9bb0',a3:.68,c4:'#f8fcff',a4:.6,
  fStrength:.55,fWidth:.35,fPower:3.6,fColor:'#ebf6ff',fAlpha:.82,
  tScale:1.1,tStrength:.24,tRough:.22,tColor:'#ffffff',tAlpha:.65,
  opacity:1,brightness:1.08,contrast:1.15,saturate:1.05,hue:0,blur:0
}));
bandsHost.appendChild(createBandUI('s','Surface',{
  width:10,offset:0,interp:1.05,armsCount:12,armsWidth:.35,armsContrast:.5,armsSpin:1.22,
  c1:'#e7ecf5',a1:.94,c2:'#9daabd',a2:.88,c3:'#4f5a6c',a3:.9,c4:'#dbe2ef',a4:.72,
  fStrength:.36,fWidth:.26,fPower:2.8,fColor:'#cae1ff',fAlpha:.68,
  tScale:1.3,tStrength:.42,tRough:.33,tColor:'#f7f9ff',tAlpha:.75,
  opacity:1,brightness:1,contrast:1.08,saturate:1.08,hue:0,blur:0
}));
bandsHost.appendChild(createBandUI('i','Inner Bevel',{
  width:5.5,offset:0,interp:1.25,armsCount:8,armsWidth:.28,armsContrast:.48,armsSpin:1.1,
  c1:'#8a95ab',a1:.72,c2:'#3f495b',a2:.9,c3:'#131821',a3:.96,c4:'#2b3442',a4:.76,
  fStrength:.22,fWidth:.2,fPower:4.1,fColor:'#9bc8ff',fAlpha:.5,
  tScale:1.05,tStrength:.3,tRough:.4,tColor:'#dce4ef',tAlpha:.52,
  opacity:1,brightness:.95,contrast:1.2,saturate:.95,hue:0,blur:0
}));

for(const el of document.querySelectorAll('[data-var]')) bindVar(el);
for(const el of document.querySelectorAll('[data-color]')) bindColor(el, el.dataset.color);
for(const o of document.querySelectorAll('[data-out]')) if(!o.textContent) o.textContent=getComputedStyle(root).getPropertyValue(o.dataset.out).trim();

const hasScrollTimeline=CSS.supports('animation-timeline: scroll()');
if(!hasScrollTimeline){
  let raf=0;
  const tick=()=>{ raf=0; const max=Math.max(1,document.documentElement.scrollHeight-innerHeight); const p=Math.max(0,Math.min(1,scrollY/max)); setVar('--scroll-progress',p.toFixed(6)); };
  addEventListener('scroll',()=>{ if(!raf) raf=requestAnimationFrame(tick); },{passive:true});
  tick();
}
</script>
</body>
</html>
